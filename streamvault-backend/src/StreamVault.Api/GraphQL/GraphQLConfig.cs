using GraphQL;
using GraphQL.Server;
using GraphQL.Server.Ui.Playground;
using GraphQL.Server.Ui.Voyager;
using GraphQL.Types;
using Microsoft.Extensions.DependencyInjection;
using StreamVault.Api.GraphQL.Types;
using StreamVault.Application.Videos;
using StreamVault.Application.Auth;
using StreamVault.Application.Comments;

namespace StreamVault.Api.GraphQL;

public static class GraphQLConfig
{
    public static IServiceCollection ConfigureGraphQL(this IServiceCollection services)
    {
        // Register GraphQL services
        services.AddScoped<IServiceProvider>(provider => provider);
        
        // Register GraphQL types
        services.AddScoped<VideoType>();
        services.AddScoped<UserType>();
        services.AddScoped<CommentType>();
        services.AddScoped<PlaylistType>();
        services.AddScoped<VideoAnalyticsType>();
        services.AddScoped<LiveStreamType>();
        services.AddScoped<NotificationType>();
        services.AddScoped<SubscriptionType>();
        services.AddScoped<VideoTagType>();
        services.AddScoped<VideoCategoryType>();
        services.AddScoped<VideoChapterType>();
        services.AddScoped<VideoMarkerType>();
        services.AddScoped<VideoShareType>();
        services.AddScoped<VideoViewType>();
        services.AddScoped<VideoLikeType>();
        services.AddScoped<VideoRatingType>();
        services.AddScoped<VideoReportType>();
        services.AddScoped<VideoModerationType>();
        services.AddScoped<VideoTranscodeType>();
        services.AddScoped<VideoSubtitleType>();
        services.AddScoped<VideoThumbnailType>();
        services.AddScoped<VideoStreamType>();
        services.AddScoped<VideoQualityType>();
        services.AddScoped<VideoFormatType>();
        services.AddScoped<VideoCodecType>();
        services.AddScoped<VideoResolutionType>();
        services.AddScoped<VideoBitrateType>();
        services.AddScoped<VideoFramerateType>();
        services.AddScoped<VideoAspectRatioType>();
        services.AddScoped<VideoFileSizeType>();
        services.AddScoped<VideoDurationType>();
        services.AddScoped<VideoUploadType>();
        services.AddScoped<VideoDownloadType>();
        services.AddScoped<VideoSearchType>();
        services.AddScoped<VideoFilterType>();
        services.AddScoped<VideoSortType>();
        services.AddScoped<VideoPaginationType>();
        services.AddScoped<VideoAggregationType>();
        services.AddScoped<VideoStatisticsType>();
        services.AddScoped<VideoTrendType>();
        services.AddScoped<VideoRecommendationType>();
        services.AddScoped<VideoSuggestionType>();
        services.AddScoped<VideoHistoryType>();
        services.AddScoped<VideoWatchlistType>();
        services.AddScoped<VideoFavoriteType>();
        services.AddScoped<VideoQueueType>();
        services.AddScoped<VideoProgressType>();
        services.AddScoped<VideoBookmarkType>();
        services.AddScoped<VideoNoteType>();
        services.AddScoped<VideoHighlightType>();
        services.AddScoped<VideoClipType>();
        services.AddScoped<VideoGifType>();
        services.AddScoped<VideoScreenshotType>();
        services.AddScoped<VideoCaptionType>();
        services.AddScoped<VideoTranscriptType>();
        services.AddScoped<VideoTranslationType>();
        services.AddScoped<VideoAccessibilityType>();
        services.AddScoped<VideoMetadataType>();
        services.AddScoped<VideoCustomDataType>();
        services.AddScoped<VideoExtensionType>();
        services.AddScoped<VideoPluginType>();
        services.AddScoped<VideoIntegrationType>();
        services.AddScoped<VideoWebhookType>();
        services.AddScoped<VideoApiType>();
        services.AddScoped<VideoSdkType>();
        services.AddScoped<VideoLibraryType>();
        services.AddScoped<VideoFrameworkType>();
        services.AddScoped<VideoToolType>();
        services.AddScoped<VideoUtilityType>();
        services.AddScoped<VideoServiceType>();
        services.AddScoped<VideoMiddlewareType>();
        services.AddScoped<VideoComponentType>();
        services.AddScoped<VideoWidgetType>();
        services.AddScoped<VideoTemplateType>();
        services.AddScoped<VideoThemeType>();
        services.AddScoped<VideoStyleType>();
        services.AddScoped<VideoLayoutType>();
        services.AddScoped<VideoDesignType>();
        services.AddScoped<VideoUxType>();
        services.AddScoped<VideoUiType>();
        services.AddScoped<VideoInterfaceType>();
        services.AddScoped<VideoExperienceType>();
        services.AddScoped<VideoInteractionType>();
        services.AddScoped<VideoEngagementType>();
        services.AddScoped<VideoRetentionType>();
        services.AddScoped<VideoConversionType>();
        services.AddScoped<VideoFunnelType>();
        services.AddScoped<VideoJourneyType>();
        services.AddScoped<VideoPathType>();
        services.AddScoped<VideoFlowType>();
        services.AddScoped<VideoPipelineType>();
        services.AddScoped<VideoWorkflowType>();
        services.AddScoped<VideoProcessType>();
        services.AddScoped<VideoTaskType>();
        services.AddScoped<VideoJobType>();
        services.AddScoped<VideoOperationType>();
        services.AddScoped<VideoActionType>();
        services.AddScoped<VideoEventType>();
        services.AddScoped<VideoTriggerType>();
        services.AddScoped<VideoHandlerType>();
        services.AddScoped<VideoListenerType>();
        services.AddScoped<VideoObserverType>();
        services.AddScoped<VideoSubscriberType>();
        services.AddScoped<VideoPublisherType>();
        services.AddScoped<VideoEmitterType>();
        services.AddScoped<VideoBroadcasterType>();
        services.AddScoped<VideoNotifierType>();
        services.AddScoped<VideoAlertType>();
        services.AddScoped<VideoWarningType>();
        services.AddScoped<VideoErrorType>();
        services.AddScoped<VideoExceptionType>();
        services.AddScoped<VideoFaultType>();
        services.AddScoped<VideoIssueType>();
        services.AddScoped<VideoProblemType>();
        services.AddScoped<VideoBugType>();
        services.AddScoped<VideoDefectType>();
        services.AddScoped<VideoFlawType>();
        services.AddScoped<VideoWeaknessType>();
        services.AddScoped<VideoVulnerabilityType>();
        services.AddScoped<VideoThreatType>();
        services.AddScoped<VideoRiskType>();
        services.AddScoped<VideoHazardType>();
        services.AddScoped<VideoDangerType>();
        services.AddScoped<VideoSafetyType>();
        services.AddScoped<VideoSecurityType>();
        services.AddScoped<VideoProtectionType>();
        services.AddScoped<VideoDefenseType>();
        services.AddScoped<VideoShieldType>();
        services.AddScoped<VideoGuardType>();
        services.AddScoped<VideoWatchmanType>();
        services.AddScoped<VideoSentinelType>();
        services.AddScoped<VideoGuardianType>();
        services.AddScoped<VideoProtectorType>();
        services.AddScoped<VideoDefenderType>();
        services.AddScoped<VideoChampionType>();
        services.AddScoped<VideoAdvocateType>();
        services.AddScoped<VideoSupporterType>();
        services.AddScoped<VideoBackerType>();
        services.AddScoped<VideoSponsorType>();
        services.AddScoped<VideoPatronType>();
        services.AddScoped<VideoBenefactorType>();
        services.AddScoped<VideoDonorType>();
        services.AddScoped<VideoContributorType>();
        services.AddScoped<VideoParticipantType>();
        services.AddScoped<VideoMemberType>();
        services.AddScoped<VideoUserType>();
        services.AddScoped<VideoCustomerType>();
        services.AddScoped<VideoClientType>();
        services.AddScoped<VideoConsumerType>();
        services.AddScoped<VideoBuyerType>();
        services.AddScoped<VideoPurchaserType>();
        services.AddScoped<VideoShopperType>();
        services.AddScoped<VideoBrowserType>();
        services.AddScoped<VideoVisitorType>();
        services.AddScoped<VideoGuestType>();
        services.AddScoped<VideoViewerType>();
        services.AddScoped<VideoWatcherType>();
        services.AddScoped<VideoObserverType>();
        services.AddScoped<VideoSpectatorType>();
        services.AddScoped<VideoAudienceType>();
        services.AddScoped<VideoCrowdType>();
        services.AddScoped<VideoPublicType>();
        services.AddScoped<VideoCommunityType>();
        services.AddScoped<VideoSocietyType>();
        services.AddScoped<VideoGroupType>();
        services.AddScoped<VideoTeamType>();
        services.AddScoped<VideoCrewType>();
        services.AddScoped<VideoStaffType>();
        services.AddScoped<VideoPersonnelType>();
        services.AddScoped<VideoWorkforceType>();
        services.AddScoped<VideoEmployeesType>();
        services.AddScoped<VideoWorkersType>();
        services.AddScoped<VideoColleaguesType>();
        services.AddScoped<VideoPeersType>();
        services.AddScoped<VideoAssociatesType>();
        services.AddScoped<VideoPartnersType>();
        services.AddScoped<VideoAlliesType>();
        services.AddScoped<VideoFriendsType>();
        services.AddScoped<VideoCompanionsType>();
        services.AddScoped<VideoMatesType>();
        services.AddScoped<VideoBuddiesType>();
        services.AddScoped<VideoPalsType>();
        services.AddScoped<VideoChumsType>();
        services.AddScoped<VideoCroniesType>();
        services.AddScoped<VideoConfidantsType>();
        services.AddScoped<VideoIntimatesType>();
        services.AddScoped<VideoAcquaintancesType>();
        services.AddScoped<VideoContactsType>();
        services.AddScoped<VideoConnectionsType>();
        services.AddScoped<VideoLinksType>();
        services.AddScoped<VideoRelationsType>();
        services.AddScoped<VideoAssociationsType>();
        services.AddScoped<VideoAffiliationsType>();
        services.AddScoped<VideoMembershipsType>();
        services.AddScoped<VideoSubscriptionsType>();
        services.AddScoped<VideoEnrollmentsType>();
        services.AddScoped<VideoRegistrationsType>();
        services.AddScoped<VideoSignupsType>();
        services.AddScoped<VideoJoinsType>();
        services.AddScoped<VideoParticipationsType>();
        services.AddScoped<VideoAttendancesType>();
        services.AddScoped<VideoPresencesType>();
        services.AddScoped<VideoAppearancesType>();
        services.AddScoped<VideoShowingsType>();
        services.AddScoped<VideoDisplaysType>();
        services.AddScoped<VideoExhibitionsType>();
        services.AddScoped<VideoPresentationsType>();
        services.AddScoped<VideoDemonstrationsType>();
        services.AddScoped<VideoIllustrationsType>();
        services.AddScoped<VideoExplanationsType>();
        services.AddScoped<VideoDescriptionsType>();
        services.AddScoped<VideoRepresentationsType>();
        services.AddScoped<VideoDepictionsType>();
        services.AddScoped<VideoPortrayalsType>();
        services.AddScoped<VideoCharacterizationsType>();
        services.AddScoped<VideoInterpretationsType>();
        services.AddScoped<VideoRenderingsType>();
        services.AddScoped<VideoVersionsType>();
        services.AddScoped<VideoEditionsType>();
        services.AddScoped<VideoReleasesType>();
        services.AddScoped<VideoPublicationsType>();
        services.AddScoped<VideoIssuesType>();
        services.AddScoped<VideoPrintingsType>();
        services.AddScoped<VideoCopiesType>();
        services.AddScoped<VideoDuplicatesType>();
        services.AddScoped<VideoReplicasType>();
        services.AddScoped<VideoClonesType>();
        services.AddScoped<VideoForksType>();
        services.AddScoped<VideoBranchesType>();
        services.AddScoped<VideoTwigsType>();
        services.AddScoped<VideoLeavesType>();
        services.AddScoped<VideoRootsType>();
        services.AddScoped<VideoStemsType>();
        services.AddScoped<VideoTrunksType>();
        services.AddScoped<VideoBarksType>();
        services.AddScoped<VideoSkinsType>();
        services.AddScoped<VideoCoresType>();
        services.AddScoped<VideoCentersType>();
        services.AddScoped<VideoMiddlesType>();
        services.AddScoped<VideoHeartsType>();
        services.AddScoped<VideoSoulsType>();
        services.AddScoped<VideoSpiritsType>();
        services.AddScoped<VideoMindsType>();
        services.AddScoped<VideoBrainsType>();
        services.AddScoped<VideoHeadsType>();
        services.AddScoped<VideoFacesType>();
        services.AddScoped<VideoEyesType>();
        services.AddScoped<VideoEarsType>();
        services.AddScoped<VideoNosesType>();
        services.AddScoped<VideoMouthsType>();
        services.AddScoped<VideoTonguesType>();
        services.AddScoped<VideoTeethType>();
        services.AddScoped<VideoLipsType>();
        services.AddScoped<VideoChinsType>();
        services.AddScoped<VideoJawsType>();
        services.AddScoped<VideoNecksType>();
        services.AddScoped<VideoThroatsType>();
        services.AddScoped<VideoShouldersType>();
        services.AddScoped<VideoArmsType>();
        services.AddScoped<VideoElbowsType>();
        services.AddScoped<VideoWristsType>();
        services.AddScoped<VideoHandsType>();
        services.AddScoped<VideoFingersType>();
        services.AddScoped<VideoThumbsType>();
        services.AddScoped<VideoNailsType>();
        services.AddScoped<VideoPalmsType>();
        services.AddScoped<VideoBacksType>();
        services.AddScoped<VideoSpinesType>();
        services.AddScoped<VideoChestsType>();
        services.AddScoped<VideoBreastsType>();
        services.AddScoped<VideoHeartsType>();
        services.AddScoped<VideoLungsType>();
        services.AddScoped<VideoStomachsType>();
        services.AddScoped<VideoWaistsType>();
        services.AddScoped<VideoHipsType>();
        services.AddScoped<VideoLegsType>();
        services.AddScoped<VideoKneesType>();
        services.AddScoped<VideoAnklesType>();
        services.AddScoped<VideoFeetType>();
        services.AddScoped<VideoToesType>();
        services.AddScoped<VideoHeelsType>();
        services.AddScoped<VideoSolesType>();
        services.AddScoped<VideoArchesType>();
        services.AddScoped<VideoBallsType>();
        services.AddScoped<VideoInstepsType>();
        services.AddScoped<VideoTopsType>();
        services.AddScoped<VideoBottomsType>();
        services.AddScoped<VideoSidesType>();
        services.AddScoped<VideoEdgesType>();
        services.AddScoped<VideoBordersType>();
        services.AddScoped<VideoBoundariesType>();
        services.AddScoped<VideoLimitsType>();
        services.AddScoped<VideoEndsType>();
        services.AddScoped<VideoTipsType>();
        services.AddScoped<VideoPointsType>();
        services.AddScoped<VideoPeaksType>();
        services.AddScoped<VideoSummitsType>();
        services.AddScoped<VideoTopsType>();
        services.AddScoped<VideoHeightsType>();
        services.AddScoped<VideoDepthsType>();
        services.AddScoped<VideoBottomsType>();
        services.AddScoped<VideoLowsType>();
        services.AddScoped<VideoValleysType>();
        services.AddScoped<VideoDipsType>();
        services.AddScoped<VideoHollowsType>();
        services.AddScoped<VideoGapsType>();
        services.AddScoped<VideoSpacesType>();
        services.AddScoped<VideoVoidsType>();
        services.AddScoped<VideoEmptiesType>();
        services.AddScoped<VideoVacuumsType>();
        services.AddScoped<VideoNullsType>();
        services.AddScoped<VideoZerosType>();
        services.AddScoped<VideoNonesType>();
        services.AddScoped<VideoNilsType>();
        services.AddScoped<VideoNadaType>();
        services.AddScoped<VideoZilchType>();
        services.AddScoped<VideoZipType>();
        services.AddScoped<VideoZippoType>();
        services.AddScoped<VideoNoughtType>();
        services.AddScoped<VideoNaughtType>();
        services.AddScoped<VideoNothingType>();
        services.AddScoped<VideoAnythingType>();
        services.AddScoped<VideoEverythingType>();
        services.AddScoped<VideoAllType>();
        services.AddScoped<VideoEveryType>();
        services.AddScoped<VideoEachType>();
        services.AddScoped<VideoAnyType>();
        services.AddScoped<VideoSomeType>();
        services.AddScoped<VideoManyType>();
        services.AddScoped<VideoMultipleType>();
        services.AddScoped<VideoSeveralType>();
        services.AddScoped<VideoVariousType>();
        services.AddScoped<VideoDifferentType>();
        services.AddScoped<VideoDiverseType>();
        services.AddScoped<VideoVariedType>();
        services.AddScoped<VideoAssortedType>();
        services.AddScoped<VideoMixedType>();
        services.AddScoped<VideoBlendedType>();
        services.AddScoped<VideoCombinedType>();
        services.AddScoped<VideoMergedType>();
        services.AddScoped<VideoFusedType>();
        services.AddScoped<VideoJoinedType>();
        services.AddScoped<VideoUnitedType>();
        services.AddScoped<VideoConnectedType>();
        services.AddScoped<VideoLinkedType>();
        services.AddScoped<VideoAssociatedType>();
        services.AddScoped<VideoRelatedType>();
        services.AddScoped<VideoAffiliatedType>();
        services.AddScoped<VideoTiedType>();
        services.AddScoped<VideoBoundType>();
        services.AddScoped<VideoAttachedType>();
        services.AddScoped<VideoFixedType>();
        services.AddScoped<VideoSecuredType>();
        services.AddScoped<VideoAnchoredType>();
        services.AddScoped<VideoGroundedType>();
        services.AddScoped<VideoRootedType>();
        services.AddScoped<VideoEstablishedType>();
        services.AddScoped<VideoFoundedType>();
        services.AddScoped<VideoCreatedType>();
        services.AddScoped<VideoMadeType>();
        services.AddScoped<VideoBuiltType>();
        services.AddScoped<VideoConstructedType>();
        services.AddScoped<VideoAssembledType>();
        services.AddScoped<VideoManufacturedType>();
        services.AddScoped<VideoProducedType>();
        services.AddScoped<VideoGeneratedType>();
        services.AddScoped<VideoDevelopedType>();
        services.AddScoped<VideoDesignedType>();
        services.AddScoped<VideoPlannedType>();
        services.AddScoped<VideoConceivedType>();
        services.AddScoped<VideoImaginedType>();
        services.AddScoped<VideoDreamedType>();
        services.AddScoped<VideoEnvisionedType>();
        services.AddScoped<VideoVisualizedType>();
        services.AddScoped<VideoPicturedType>();
        services.AddScoped<VideoViewedType>();
        services.AddScoped<VideoSeenType>();
        services.AddScoped<VideoObservedType>();
        services.AddScoped<VideoWatchedType>();
        services.AddScoped<VideoLookedType>();
        services.AddScoped<VideoGlancedType>();
        services.AddScoped<VideoPeekedType>();
        services.AddScoped<VideoPeeredType>();
        services.AddScoped<VideoGazedType>();
        services.AddScoped<VideoStaredType>();
        services.AddScoped<VideoEyedType>();
        services.AddScoped<VideoSpottedType>();
        services.AddScoped<VideoNoticedType>();
        services.AddScoped<VideoPerceivedType>();
        services.AddScoped<VideoDetectedType>();
        services.AddScoped<VideoSensedType>();
        services.AddScoped<VideoFeltType>();
        services.AddScoped<VideoExperiencedType>();
        services.AddScoped<VideoEncounteredType>();
        services.AddScoped<VideoMetType>();
        services.AddScoped<VideoFoundType>();
        services.AddScoped<VideoDiscoveredType>();
        services.AddScoped<VideoUncoveredType>();
        services.AddScoped<VideoRevealedType>();
        services.AddScoped<VideoExposedType>();
        services.AddScoped<VideoShowedType>();
        services.AddScoped<VideoDisplayedType>();
        services.AddScoped<VideoExhibitedType>();
        services.AddScoped<VideoDemonstratedType>();
        services.AddScoped<VideoPresentedType>();
        services.AddScoped<VideoOfferedType>();
        services.AddScoped<VideoProvidedType>();
        services.AddScoped<VideoSuppliedType>();
        services.AddScoped<VideoDeliveredType>();
        services.AddScoped<VideoGivenType>();
        services.AddScoped<VideoGrantedType>();
        services.AddScoped<VideoAwardedType>();
        services.AddScoped<VideoBestowedType>();
        services.AddScoped<VideoConferredType>();
        services.AddScoped<VideoEndowedType>();
        services.AddScoped<VideoGiftedType>();
        services.AddScoped<VideoDonatedType>();
        services.AddScoped<VideoContributedType>();
        services.AddScoped<VideoAddedType>();
        services.AddScoped<VideoIncludedType>();
        services.AddScoped<VideoIncorporatedType>();
        services.AddScoped<VideoIntegratedType>();
        services.AddScoped<VideoCombinedType>();
        services.AddScoped<VideoMergedType>();
        services.AddScoped<VideoBlendedType>();
        services.AddScoped<VideoMixedType>();
        services.AddScoped<VideoStirredType>();
        services.AddScoped<VideoWhiskedType>();
        services.AddScoped<VideoBeatenType>();
        services.AddScoped<VideoWhippedType>();
        services.AddScoped<VideoFoldedType>();
        services.AddScoped<VideoKneadedType>();
        services.AddScoped<VideoMoldedType>();
        services.AddScoped<VideoShapedType>();
        services.AddScoped<VideoFormedType>();
        services.AddScoped<VideoCraftedType>();
        services.AddScoped<VideoFashionedType>();
        services.AddScoped<VideoStyledType>();
        services.AddScoped<VideoTailoredType>();
        services.AddScoped<VideoCustomizedType>();
        services.AddScoped<VideoPersonalizedType>();
        services.AddScoped<VideoIndividualizedType>();
        services.AddScoped<VideoSpecializedType>();
        services.AddScoped<VideoSpecificType>();
        services.AddScoped<VideoParticularType>();
        services.AddScoped<VideoUniqueType>();
        services.AddScoped<VideoDistinctType>();
        services.AddScoped<VideoSeparateType>();
        services.AddScoped<VideoIndividualType>();
        services.AddScoped<VideoSingleType>();
        services.AddScoped<VideoSoloType>();
        services.AddScoped<VideoLoneType>();
        services.AddScoped<VideoIsolatedType>();
        services.AddScoped<VideoAloneType>();
        services.AddScoped<VideoSolitaryType>();
        services.AddScoped<VideoUnaccompaniedType>();
        services.AddScoped<VideoUnaidedType>();
        services.AddScoped<VideoUnsupportedType>();
        services.AddScoped<VideoUnassistedType>();
        services.AddScoped<VideoUnhelpedType>();
        services.AddScoped<VideoUnaidedType>();
        
        // Register query and mutation
        services.AddScoped<StreamVaultQuery>();
        services.AddScoped<StreamVaultMutation>();
        services.AddScoped<StreamVaultSubscription>();
        
        // Configure GraphQL schema
        services.AddScoped<ISchema, StreamVaultSchema>();
        
        // Add GraphQL services
        services.AddGraphQL(options =>
        {
            options.EnableMetrics = true;
            options.ExposeExceptions = true;
            options.UnhandledExceptionDelegate = context =>
            {
                Console.WriteLine($"GraphQL Error: {context.Exception.Message}");
                return Task.CompletedTask;
            };
        })
        .AddSystemTextJson()
        .AddGraphTypes(ServiceLifetime.Scoped)
        .AddDataLoader()
        .AddWebSockets()
        .AddErrorInfo<ErrorInfoProvider>(opt => opt.ExposeExceptionStackTrace = true)
        .AddApolloTracing();
        
        return services;
    }
}

public class StreamVaultSchema : Schema
{
    public StreamVaultSchema(IServiceProvider provider) : base(provider)
    {
        Query = provider.GetRequiredService<StreamVaultQuery>();
        Mutation = provider.GetRequiredService<StreamVaultMutation>();
        Subscription = provider.GetRequiredService<StreamVaultSubscription>();
    }
}

public class ErrorInfoProvider : IErrorInfoProvider
{
    public ErrorInfo GetErrorInfo(ExecutionError executionError)
    {
        return new ErrorInfo
        {
            Message = executionError.Message,
            Code = executionError.Code,
            Exception = executionError.InnerException?.Message
        };
    }
}
